<title>711</title>
<button onclick="post()">讀取711點位</button>
<button onclick="request()">請求All16-17-18jpg80.json</button>
<script>
var auth
fetch('https://call-oa.onrender.com/twoTokens').then(res=>res.text()).then(data=>{data=data.split('\n');auth=data[1]})

function post(){

 fetch("https://cors-rrw.onrender.com/emap.pcsc.com.tw:443/EMapSDK.aspx",
       {method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},
       body:"commandid=Search0007&x1=120596924&y1=24106647&x2=120607910&y2=24116675"})
 .then(res=>{if(!res.ok)throw new Error(`post error! status:${res.status}`);return res.text()})
 .then(data=>{console.log(data)})
 .catch(e=>console.log(e))
}

function request(){
 console.log(auth)
 const jsonUrl='https://www.googleapis.com/drive/v3/files/1EG8-IkWAPTiP_GwwDr0tsjEu8Hp33RxO?alt=media'
 fetch(jsonUrl,
       {headers:{'Authorization':auth}})
 .then(res=>res.json()).then(data=>{console.log(data[16])}).catch(e=>console.log('請求All16-17-18jpg80.json錯誤',e))


return
/*

jsonXhr.open('GET',jsonUrl,true)
  jsonXhr.responseType='json'
  jsonXhr.setRequestHeader('Authorization',auth)
  jsonXhr.send()
  jsonXhr.onload=()=>{
   mapJson=jsonXhr.response



*/




}

</script>