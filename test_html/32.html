<button onclick="create()">轉建</button>
<script>
var token='ya29.a0AfB_byBBsdMFVJhaV8XyfCBxL1ywk9HAoImxtEoqR-vJJa3zQHZhrdycfOZUqmxHXRLcIoI82e2ucJ9ixX7g9boDcHGImKOQ-H2DUFBP3k-kLOxoVdlJMIEjbxN5_6P3bf-6CWlDu6fYItFFWhcUFWrj6eUw9BN5M-uYaCgYKAYwSARESFQHGX2Mi8wApl8D-TyE0ZQnjwQ4osA0171'
var id='1PjAKLGZNV_lzZGvI15YAz7KV29cUCGAA'
const create=async()=>{
 let res=await fetch(`https://www.googleapis.com/drive/v2/files/${id}`,{headers:{'Authorization':'Bearer '+token}})
 let body=await res.json()
 const{parents,modifiedDate}=body
 console.log(body,parents,modifiedDate)
 res=await fetch(`https://www.googleapis.com/drive/v2/files/${id}/copy`,{method:"POST",headers:{'Authorization':'Bearer '+'ya29.a0AfB_byD7Oqxd-vy77Hw1BeybjI-ra8vfgBj8n02brc8ryLcHeHvhYX5YxOZJDNQKbkw2wvEhAbTkstgkv1fpzie8xDzpTONF0GnBMZ-pKFZwaX6u7aqE9SjTfVHx7_aTbLzLEeTU9tJjGvZZ3bBFxlo7Z3oM0S7W3hMaCgYKATcSARMSFQHGX2Mi_WOgB-0PsrjxH_2tKVNVmg0170'
 ,'Content-Type':'application/json'},body:JSON.stringify({modifiedDate:modifiedDate,parents:parents})})
 //body=await res.json();console.log(body)
 fetch(`https://script.google.com/macros/s/AKfycbxHSWHtQg_qH-CSJGAbo5jUFqm6udTABUlweLugH1hpJVJnEo0/exec?editor=onibg.00001@gmail.com$${id}`)//與我共用(v2internal?)
}




//POST https://www.googleapis.com/drive/v2/files/1VMa2H9EPlSpIbjniiP2DUXp6UoNP3NjE/copy

/*
let num=prompt("onibg.00000@gmail.com","00000"),newOwnerMail='onibg.'+num.padStart(5,'0')+'@gmail.com'
 arr.forEach(async(element)=>{//https://gist.github.com/tanaikech/685929fd4e739c943ab0b4c53348a4af
                              let res=await fetch(`https://www.googleapis.com/drive/v2/files/${element}`,{headers:{'Authorization':'Bearer '+onibgObj[Gmail].token}})
                              let body=await res.json()
                              const thisMail=body.owners[0].emailAddress
                              const {modifiedDate}=body
                              res=await fetch(`https://www.googleapis.com/drive/v2/files/${element}/permissions`,{method:"POST",headers:{'Authorization':'Bearer '+onibgObj[thisMail].token,'Content-Type':'application/json'},body:JSON.stringify({role:'writer',type:'user',value:newOwnerMail,pendingOwner:true})})
                              body=await res.json()
                              res=await fetch(`https://www.googleapis.com/drive/v2/files/${element}/permissions`,{method:"POST",headers:{'Authorization':'Bearer '+onibgObj[newOwnerMail].token,'Content-Type':'application/json'},body:JSON.stringify({role:'owner',type:'user',value:newOwnerMail})})
                              //?moveToNewOwnersRoot=true
                              body=await res.json()
                              console.log(thisMail,body)
                              fetch(`https://www.googleapis.com/drive/v2/files/${element}?setModifiedDate=true`,{method:"PATCH",headers:{'Authorization':'Bearer '+onibgObj[newOwnerMail].token},body:JSON.stringify({modifiedDate:modifiedDate})})
                              fetch(`https://script.google.com/macros/s/AKfycbxHSWHtQg_qH-CSJGAbo5jUFqm6udTABUlweLugH1hpJVJnEo0/exec?editor=${newOwnerMail}$${element}`)//與我共用(v2internal?)
                            })
                            
                            */
</script>