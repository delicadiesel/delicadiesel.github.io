<button onclick="create()">轉建</button>
<script>
var token='ya29.a0AfB_byDziyVqObEBfSmm1CftOlq9F33fhpXASQ3Npg-iF_zYJBiZHbVphPtRF8o7Lpruy7-7bLVJm2TK0a9aNnJcw4smmIOIQ_Bcmb3szFSSAT4l8-cAx-jDzTflqPd9Z48hNFspIldDaz4cylk99Rur584aSjWg_8Q8aCgYKAfoSARASFQHGX2MibQblYnmFVO7tGa3bc-H3fw0171'




</script>







//POST https://www.googleapis.com/drive/v3/files/1EmuJ6nwW8Q8YysOBf1VQOz4gAk_uT2V-/copy

/*
let num=prompt("onibg.00000@gmail.com","00000"),newOwnerMail='onibg.'+num.padStart(5,'0')+'@gmail.com'
 arr.forEach(async(element)=>{//https://gist.github.com/tanaikech/685929fd4e739c943ab0b4c53348a4af
                              let res=await fetch(`https://www.googleapis.com/drive/v2/files/${element}`,{headers:{'Authorization':'Bearer '+onibgObj[Gmail].token}})
                              let body=await res.json()
                              const thisMail=body.owners[0].emailAddress
                              const {modifiedDate}=body
                              res=await fetch(`https://www.googleapis.com/drive/v2/files/${element}/permissions`,{method:"POST",headers:{'Authorization':'Bearer '+onibgObj[thisMail].token,'Content-Type':'application/json'},body:JSON.stringify({role:'writer',type:'user',value:newOwnerMail,pendingOwner:true})})
                              body=await res.json()
                              res=await fetch(`https://www.googleapis.com/drive/v2/files/${element}/permissions`,{method:"POST",headers:{'Authorization':'Bearer '+onibgObj[newOwnerMail].token,'Content-Type':'application/json'},body:JSON.stringify({role:'owner',type:'user',value:newOwnerMail})})
                                                                                                             //?moveToNewOwnersRoot=true
                              body=await res.json()
                              console.log(thisMail,body)
                              fetch(`https://www.googleapis.com/drive/v2/files/${element}?setModifiedDate=true`,{method:"PATCH",headers:{'Authorization':'Bearer '+onibgObj[newOwnerMail].token},body:JSON.stringify({modifiedDate:modifiedDate})})
                              fetch(`https://script.google.com/macros/s/AKfycbxHSWHtQg_qH-CSJGAbo5jUFqm6udTABUlweLugH1hpJVJnEo0/exec?editor=${newOwnerMail}$${element}`)//與我共用(v2internal?)
                             })

                             */