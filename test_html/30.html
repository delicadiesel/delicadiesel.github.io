<div>google雲端硬碟list測試</div>
<button onclick="list()">list</button>
<script>
var id='1DFNIHjZv3fhK9FU6k5aCzHUg79LFOuG0'
 function list(){
  var token ='ya29.a0AfB_byD9168Mo1zMgTZ_nCyWrlRl6ue2sOc9g_8Bo4QRPJGqYSb-3OdVOpp4ESK5GKBnSjmaXUidjhFuxfuzH4xt6eYIC0trx4XdzB5CMtqAlFJ8qO8gAqQXI7CW8CKOUMviI8SkvejLEWP-lxlU-uEMH0Z637uSb7ZGaCgYKARcSARASFQHGX2MidijFepTPEtiPpOTW686SiA0171'
  var xhr=new XMLHttpRequest()
  xhr.open('GET',`https://www.googleapis.com/drive/v3/files?q='${id}'+in+parents+and+trashed=false&orderBy=folder&fields=files(mimeType,name)&pageSize=1000`,true)
  //xhr.open('GET',`https://www.googleapis.com/drive/v3/files?q='${id}'+in+parents+and+trashed=false+and+mimeType='application/vnd.google-apps.folder'&pageSize=5`,true)
  //xhr.open('GET',`https://www.googleapis.com/drive/v3/files?q='${id}'+in+parents+and+trashed=false+and+not+mimeType='application/vnd.google-apps.folder'&pageSize=5`,true)
  xhr.responseType='json'
  xhr.setRequestHeader('Authorization','Bearer '+token)
  xhr.send()
  xhr.onload=()=>{
   console.log('onload',xhr.response)
   const arr=xhr.response.files
   let foldersCount=arr.findIndex(item=>item.mimeType!='application/vnd.google-apps.folder')
   if(foldersCount==-1)foldersCount=arr.length
   let filesCount=arr.length-foldersCount
   const foldersObj={},filesObj={}
   const foldersArr=[],filesArr=[]
   arr.forEach((item,index)=>{
   if(index<foldersCount)
   {
    if(foldersArr.includes(item.name)){foldersObj[item.name]=foldersObj[item.name]?++foldersObj[item.name]:1}else{foldersArr.push(item.name)}
   }
   else
   {
    if(filesArr.includes(item.name)){filesObj[item.name]=filesObj[item.name]?++filesObj[item.name]:1}else{filesArr.push(item.name)}
   }
})
   
   console.log(
  `資料夾:${foldersCount}個
     檔案:${filesCount}個
重複資料夾：${JSON.stringify(folderObj)}
  重複檔案：${JSON.stringify(filesObj)}`)
}
 }


</script>