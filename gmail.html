
<button onclick="read()">read</button>
<table style="display:none" border="5">
</table>
<script>
 var table=document.querySelector('table')
 var onibgObj={}
 fetch('https://script.google.com/macros/s/AKfycbxIKVXrmO86jLZOu0NDDoN6d3yutuCEYa-JOQ0qTHCZvq8i7IWkNCVwweTpe9dxgBH4rA/exec?onibg')
 .then(res=>res.text())
 .then(data=>{let i=0
  for(const item of data.split('\n')){
   const mail_url=item.split(',')
   onibgObj[mail_url[0]]={}
   onibgObj[mail_url[0]].url=mail_url[1]
   onibgObj[mail_url[0]].row=++i
   getToken(mail_url)
   const row=document.createElement('tr')
   const cell=document.createElement('td')
   cell.textContent=mail_url[0]
   row.appendChild(cell)
   table.appendChild(row)
  }
 var tr=document.querySelectorAll('tr')
 table.style.display='table'
})
function getToken(mail_url){
 fetch(mail_url[1])
 .then(res=>res.text())
 .then(data=>{onibgObj[mail_url[0]].token=data})
}
setInterval(()=>{
 for(const mail in onibgObj){getToken([mail,onibgObj[mail].url])}
},3000000)
function read(){
 let i=0
 for(const mail in onibgObj){
  const cell=document.createElement('td')
  fetch('https://www.googleapis.com/drive/v3/about?fields=storageQuota',{headers:{'Authorization':'Bearer '+onibgObj[mail].token}})
  .then(res=>res.json())
  .then(data=>{
   cell.textContent=data.usageInDriveTrash
   tr[i++].appendChild(cell)
 }) 


}



}






console.log(onibgObj)


</script>
  