
<button onclick="read()">read</button>
<table border="5">
</table>
<script>
 var table=document.querySelector('table')
 var onibgObj={}
 fetch('https://script.google.com/macros/s/AKfycbxIKVXrmO86jLZOu0NDDoN6d3yutuCEYa-JOQ0qTHCZvq8i7IWkNCVwweTpe9dxgBH4rA/exec?onibg')
 .then(res=>res.text())
 .then(data=>{
  for(const item of data.split('\n')){
   const mail_url=item.split(',')
   onibgObj[mail_url[0]]={}
   onibgObj[mail_url[0]].url=mail_url[1]
   getToken(mail_url)
   const row=document.createElement('tr')
   const cell=document.createElement('td')
   cell.textContent=mail_url[0]
   row.appendChild(cell)
   table.appendChild(row)
  }
})
function getToken(mail_url){
 fetch(mail_url[1])
 .then(res=>res.text())
 .then(data=>{onibgObj[mail_url[0]].token=data})
}
setInterval(()=>{
 for(var mail in onibgObj){getToken([mail,onibgObj[mail].url])}
},3000000)
function read(){
 for(const i in onibgObj){
console.log(i)
 }



}






console.log(onibgObj)


</script>
  